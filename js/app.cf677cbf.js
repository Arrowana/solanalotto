(function(e){function t(t){for(var r,c,o=t[0],a=t[1],s=t[2],p=0,f=[];p<o.length;p++)c=o[p],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&f.push(i[c][0]),i[c]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);l&&l(t);while(f.length)f.shift()();return u.push.apply(u,s||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n=u[t],r=!0,o=1;o<n.length;o++){var a=n[o];0!==i[a]&&(r=!1)}r&&(u.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},i={app:0},u=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/solanalotto/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var l=a;u.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"03c3":function(e,t,n){"use strict";n("5d3b")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("p",[e._v("Solanalotto")]),n("div",[n("p",[e._v("Cluster")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.cluster,expression:"cluster"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.cluster=t.target.multiple?n:n[0]}}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Cluster")]),n("option",[e._v("devnet")]),n("option",[e._v("localnet")])]),n("ul",[n("li",[n("label",[e._v("Private key:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.privateKey,expression:"privateKey"}],domProps:{value:e.privateKey},on:{input:function(t){t.target.composing||(e.privateKey=t.target.value)}}}),e.privateKeyError?n("p",[e._v(e._s(e.privateKeyError))]):e._e()]),n("li",[n("label",[e._v("Program id:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.programId,expression:"programId"}],domProps:{value:e.programId},on:{input:function(t){t.target.composing||(e.programId=t.target.value)}}})])]),null!==e.sol?n("p",[e._v(e._s(e.sol)+" SOL")]):e._e()]),n("CreateLottery",{attrs:{privateKey:e.privateKey,programId:e.programId}}),n("Lotteries",{attrs:{lotteries:e.lotteries,userAccountPubkey:e.userAccountPubkey},on:{enter:e.onEnter,receive:e.onReceive}})],1)},u=[],c=(n("96cf"),n("1da1")),o=n("64b9"),a=n("8721"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("New lottery")]),n("label",[e._v("Ticket price:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.ticketPrice,expression:"ticketPrice"}],domProps:{value:e.ticketPrice},on:{input:function(t){t.target.composing||(e.ticketPrice=t.target.value)}}}),e._v(" SOL "),n("button",{attrs:{disabled:!e.canCreate()},on:{click:e.create}},[e._v("Create")]),e.canCreate()?e._e():n("p",[e._v("Private key and program id required")])])},l=[],p={data:function(){return{ticketPrice:1}},props:{privateKey:{type:String,required:!0},programId:{type:String,required:!0}},methods:{create:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["e"])(this.$props.privateKey,this.$data.ticketPrice,this.$props.programId);case 2:t=e.sent,console.log("lotteryInfo: ".concat(t.ticketPrice));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),canCreate:function(){return""!==this.$propsprivateKey&&""!==this.$props.programId}}},f=p,d=n("2877"),v=Object(d["a"])(f,s,l,!1,null,null,null),m=v.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v("Lotteries")]),n("p",[e._v(" Ongoing lotteries ")]),n("div",[e._l(e.lotteries,(function(t,r){return n("ul",{key:r},[n("li",[e._v("Lottery account "),n("a",{attrs:{href:"https://explorer.solana.com/address/"+t.lotteryAccountPubkey+"?customUrl=http://127.0.0.1:8899&cluster=custom"}},[e._v(e._s(t.lotteryAccountPubkey.slice(0,8))+"...")])]),n("li",[e._v("Ticket price: "+e._s(t.ticketPrice/e.LAMPORTS_PER_SOL)+" SOL")]),n("li",[e._v("Winnings: "+e._s(t.ticketPrice/e.LAMPORTS_PER_SOL*t.max_entrant_count)+" SOL")]),n("li",[e._v("Entrants: "+e._s(t.entrants.length)+"/"+e._s(t.max_entrant_count))]),t.winnerAccountPubkey?n("li",[e._v("Winner "),n("a",{attrs:{href:""}},[e._v(e._s(t.winnerAccountPubkey))])]):e._e(),e.userAccountPubkey&&e.userAccountPubkey===t.winnerAccountPubkey?n("li",[n("button",{attrs:{id:"claim"},on:{click:function(n){return e.receive(t)}}},[e._v("Claim")])]):e._e(),!e.userAccountPubkey||t.winnerAccountPubkey||t.entrants.includes(e.userAccountPubkey)?e._e():n("button",{on:{click:function(n){return e.enter(t)}}},[e._v("Enter")]),t.entrants.includes(e.userAccountPubkey)?n("p",[e._v("Entered")]):e._e()])})),0==e.lotteries.length?n("p",[e._v("No lottery")]):e._e()],2)])},b=[],g={props:["lotteries","userAccountPubkey"],data:function(){return{LAMPORTS_PER_SOL:o["c"]}},methods:{enter:function(e){this.$emit("enter",e)},receive:function(e){this.$emit("receive",e)}}},y=g,w=(n("03c3"),Object(d["a"])(y,h,b,!1,null,"6d924583",null)),k=w.exports,_={name:"App",data:function(){return{cluster:"devnet",userAccount:null,userAccountInfo:null,privateKey:"",privateKeyError:null,programId:"",lotteries:[]}},components:{CreateLottery:m,Lotteries:k},watch:{cluster:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={devnet:"https://devnet.solana.com",localnet:"http://127.0.0.1:8899"},Object(a["a"])(n[t]),e.next=4,Object(a["c"])(this.userAccount);case 4:this.userAccountInfo=e.sent;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),programId:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchLotteries();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),privateKey:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.privateKeyError=null,this.userAccount=null,e.prev=2,this.userAccount=Object(a["f"])(t),e.next=6,Object(a["c"])(this.userAccount);case 6:this.userAccountInfo=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.privateKeyError=e.t0.message;case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));function t(t){return e.apply(this,arguments)}return t}()},computed:{userAccountPubkey:function(){var e;return null===(e=this.userAccount)||void 0===e?void 0:e.publicKey.toBase58()},sol:function(){var e;return(null===(e=this.userAccountInfo)||void 0===e?void 0:e.lamports)/o["c"]}},methods:{onEnter:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["b"])(this.privateKey,t.lotteryAccountPubkey,this.programId);case 2:return n=e.sent,console.log(n),e.next=6,this.fetchLotteries();case 6:return e.next=8,Object(a["c"])(this.userAccount);case 8:this.userAccountInfo=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onReceive:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["g"])(this.privateKey,t.lotteryAccountPubkey,this.programId);case 2:return n=e.sent,console.log(n),e.next=6,this.fetchLotteries();case 6:return e.next=8,Object(a["c"])(this.userAccount);case 8:this.userAccountInfo=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),fetchLotteries:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["d"])(this.$data.programId);case 2:t=e.sent,console.log(t),this.lotteries=t;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},P=_,x=(n("034f"),Object(d["a"])(P,i,u,!1,null,null,null)),A=x.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(A)}}).$mount("#app")},"5d3b":function(e,t,n){},"85ec":function(e,t,n){},8721:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return v})),n.d(t,"d",(function(){return b}));n("99af"),n("4de4"),n("d81d"),n("d3b7"),n("ac1f"),n("1276"),n("96cf");var r=n("1da1"),i=n("64b9"),u=n("399f"),c=n.n(u),o=n("c4c1"),a=new i["b"]("http://localhost:8899","singleGossip"),s=function(e){a=new i["b"](e,"singleGossip")},l=function(e){var t=e.split(",").map((function(e){return parseInt(e)}));return new i["a"](t)},p=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.getAccountInfo(t.publicKey,"singleGossip");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,u){var c,s,l,p,f,d,v,m,b,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=n.split(",").map((function(e){return parseInt(e)})),s=new i["a"](c),console.log("initializer pubKey: ".concat(s.publicKey.toBase58())),l=new i["d"](u),p=new i["a"],t.t0=i["f"],t.t1=s.publicKey,t.t2=p.publicKey,t.t3=o["a"].span,t.next=11,a.getMinimumBalanceForRentExemption(o["a"].span,"singleGossip");case 11:return t.t4=t.sent,t.t5=r*i["c"],t.t6=t.t4+t.t5,t.t7=l,t.t8={fromPubkey:t.t1,newAccountPubkey:t.t2,space:t.t3,lamports:t.t6,programId:t.t7},f=t.t0.createAccount.call(t.t0,t.t8),d=e.concat([e.from([0]),s.publicKey.toBuffer()]),v=new i["h"]({programId:l,keys:[{pubkey:p.publicKey,isSigner:!1,isWritable:!0},{pubkey:i["e"],isSigner:!1,isWritable:!1}],data:d}),m=(new i["g"]).add(f,v),t.next=22,a.sendTransaction(m,[s,p],{skipPreflight:!1,preflightCommitment:"singleGossip"});case 22:return b=t.sent,console.log("Tx signature: ".concat(b)),t.next=26,new Promise((function(e){return setTimeout(e,1e3)}));case 26:return t.next=28,a.getAccountInfo(p.publicKey,"singleGossip");case 28:return g=t.sent,t.abrupt("return",h(p.publicKey,g));case 30:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),d=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,u){var c,o,s,l,p,f,d,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=n.split(",").map((function(e){return parseInt(e)})),o=new i["a"](c),s=new i["d"](r),l=new i["d"](u),p=new i["h"]({programId:l,keys:[{pubkey:o.publicKey,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:i["f"].programId,isSigner:!1,isWritable:!1}],data:e.from([1])}),f=(new i["g"]).add(p),t.next=8,a.sendTransaction(f,[o],{skipPreflight:!1,preflightCommitment:"singleGossip"});case 8:return d=t.sent,console.log("Tx signature: ".concat(d)),t.next=12,new Promise((function(e){return setTimeout(e,1e3)}));case 12:return t.next=14,a.getAccountInfo(s,"singleGossip");case 14:return v=t.sent,t.abrupt("return",h(s,v));case 16:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),v=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,u){var c,o,s,l,p,f,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=n.split(",").map((function(e){return parseInt(e)})),o=new i["a"](c),s=new i["d"](r),l=new i["d"](u),p=new i["h"]({programId:l,keys:[{pubkey:o.publicKey,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0}],data:e.from([2])}),f=(new i["g"]).add(p),t.next=8,a.sendTransaction(f,[o],{skipPreflight:!1,preflightCommitment:"singleGossip"});case 8:d=t.sent,console.log("Tx signature: ".concat(d));case 10:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),m="11111111111111111111111111111111",h=function(e,t){var n=o["a"].decode(t.data),r=new i["d"](n.winnerAccountPubkey).toBase58(),u=n.entrants.map((function(e){return new i["d"](e).toBase58()})).filter((function(e){return e!==m}));return{lotteryAccountPubkey:e.toBase58(),isInitialized:!!n.isInitialized,initializerAccountPubkey:new i["d"](n.initializerPubkey).toBase58(),ticketPrice:new c.a(n.ticketPrice,10,"le").toNumber(),winnerAccountPubkey:r!=m?r:null,entrants:u,max_entrant_count:5}},b=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new i["d"](t),e.next=3,a.getProgramAccounts(n,"singleGossip");case 3:return r=e.sent,e.abrupt("return",r.map((function(e){var t=e.pubkey,n=e.account;return h(t,n)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}).call(this,n("1c35").Buffer)},c4c1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("901e"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"publicKey";return r["blob"](32,e)},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uint64";return r["blob"](8,e)},c=5,o=r["struct"]([r["u8"]("isInitialized"),i("initializerPubkey"),u("ticketPrice"),i("winnerAccountPubkey"),r["seq"](i(),c,"entrants")])}});
//# sourceMappingURL=app.cf677cbf.js.map