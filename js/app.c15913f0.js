(function(e){function t(t){for(var r,i,o=t[0],u=t[1],s=t[2],p=0,f=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},c=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/solanalotto/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var l=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},"3de1":function(e,t,n){},4:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{style:{background:e.$vuetify.theme.themes["dark"].background},attrs:{id:"app"}},[r("v-app-bar",{attrs:{app:""}},[r("v-row",{staticClass:"mt-6"},[r("v-col",[r("v-toolbar-title",[e._v("Solanalotto")])],1),r("v-col"),r("v-col",[e._v("sollet.io "),r("v-btn",{on:{click:e.connect}},[e._v("Connect")])],1),r("v-col",[r("v-select",{attrs:{label:"Cluster",items:e.clusters},model:{value:e.cluster,callback:function(t){e.cluster=t},expression:"cluster"}})],1)],1)],1),r("v-spacer"),r("v-main",[r("v-container",[r("v-img",{staticClass:"mx-auto",attrs:{src:n("b0e8"),"max-width":"25%"}})],1),r("v-container",[null!==this.userPublicKey?r("p",[e._v("Pubkey: "+e._s(this.userPublicKey.toBase58()))]):r("v-alert",{attrs:{border:"left",color:"red",type:"warning",dark:""}},[e._v("Connect wallet to reveal balance and interact with lotteries")]),null!==e.sol?r("p",[e._v(e._s(e.sol)+" SOL")]):e._e(),r("v-checkbox",{attrs:{label:"Choose program ID"},model:{value:e.customProgramId,callback:function(t){e.customProgramId=t},expression:"customProgramId"}}),e.customProgramId?r("v-text-field",{attrs:{label:"Custom program ID"},model:{value:e.programId,callback:function(t){e.programId=t},expression:"programId"}}):e._e()],1),r("v-container",[r("CreateLottery",{attrs:{canCreate:null!==this.userPublicKey},on:{create:e.onCreate}})],1),r("v-container",[r("v-row",[r("Lotteries",{attrs:{lotteries:e.lotteries,userAccountPubkey:null!==this.userPublicKey&&this.userPublicKey.toBase58()},on:{enter:e.onEnter,receive:e.onReceive}})],1)],1)],1)],1)},c=[],i=(n("b64b"),n("96cf"),n("1da1")),o=n("64b9"),u=n("864c"),s=n("8721"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-title",[e._v("New lottery")]),n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12",sm:"6",md:"8"}},[n("v-container",[n("v-text-field",{attrs:{label:"Ticket price",type:"number"},model:{value:e.ticketPrice,callback:function(t){e.ticketPrice=t},expression:"ticketPrice"}})],1)],1),n("v-col",{attrs:{cols:"6",md:"4"}},[n("v-container",[n("v-btn",{attrs:{disabled:!e.canCreate},on:{click:e.create}},[e._v("Create")])],1)],1)],1)],1)},p=[],f={data:function(){return{ticketPrice:1}},props:{canCreate:{type:Boolean,required:!0}},methods:{create:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("create",this.ticketPrice);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},d=f,h=n("2877"),b=n("6544"),m=n.n(b),v=n("8336"),g=n("b0af"),y=n("99d9"),k=n("62ad"),w=n("a523"),x=n("0fd9"),P=n("8654"),_=Object(h["a"])(d,l,p,!1,null,null,null),R=_.exports;m()(_,{VBtn:v["a"],VCard:g["a"],VCardTitle:y["c"],VCol:k["a"],VContainer:w["a"],VRow:x["a"],VTextField:P["a"]});var O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("h1",[e._v("Lotteries")]),n("p",[e._v(" Ongoing lotteries ")]),null===e.lotteries?n("v-container",[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):e._l(e.lotteries,(function(t,r){return n("v-card",{key:r,attrs:{tile:"",elevation:"3",outlined:""}},[n("v-card-title",[e._v("Lottery account "),n("a",{attrs:{href:"https://explorer.solana.com/address/"+t.lotteryAccountPubkey+"?customUrl=http://127.0.0.1:8899&cluster=custom"}},[e._v(e._s(t.lotteryAccountPubkey.slice(0,8))+"...")])]),n("v-card-text",[n("v-list-item",[e._v("Ticket price: "+e._s(t.ticketPrice/e.LAMPORTS_PER_SOL)+" SOL")]),n("v-list-item",[e._v("Winnings: "+e._s(t.ticketPrice/e.LAMPORTS_PER_SOL*t.max_entrant_count)+" SOL")]),n("v-list-item",[e._v("Entrants: "+e._s(t.entrants.length)+"/"+e._s(t.max_entrant_count))]),t.winnerAccountPubkey?n("v-list-item",[e._v("Winner "),n("a",{attrs:{href:"https://explorer.solana.com/address/"+t.winnerAccountPubkey+"?customUrl=http://127.0.0.1:8899&cluster=custom"}},[e._v(e._s(t.winnerAccountPubkey))])]):e._e()],1),n("v-card-actions",[e.userAccountPubkey&&e.userAccountPubkey===t.winnerAccountPubkey?n("v-btn",{attrs:{color:"green lighten-1"},on:{click:function(n){return e.receive(t)}}},[e._v("Claim")]):e._e(),!e.userAccountPubkey||t.winnerAccountPubkey||t.entrants.includes(e.userAccountPubkey)?e._e():n("v-btn",{on:{click:function(n){return e.enter(t)}}},[e._v("Enter")]),t.entrants.includes(e.userAccountPubkey)?n("v-btn",{attrs:{disabled:""}},[e._v("Entered")]):e._e()],1)],1)})),null!==e.lotteries&&0==e.lotteries.length?n("p",[e._v("No lottery")]):e._e()],2)},j=[],A={props:["lotteries","userAccountPubkey"],data:function(){return{LAMPORTS_PER_SOL:o["c"]}},methods:{enter:function(e){this.$emit("enter",e)},receive:function(e){this.$emit("receive",e)}}},C=A,I=(n("abd5"),n("da13")),V=n("490a"),T=Object(h["a"])(C,O,j,!1,null,"4dad0b46",null),K=T.exports;m()(T,{VBtn:v["a"],VCard:g["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VContainer:w["a"],VListItem:I["a"],VProgressCircular:V["a"]});var B={devnet:{url:Object(o["i"])("devnet"),programId:"3zAfBWGppVofNk9Cqfziob3QTLT2BPECmpmj2P66eWNJ"},localnet:{url:"http://127.0.0.1:8899",programId:"72MgRTDhBWRveLLJn7D1uz21D4bW76PJd6q1oFGVxbmK"}},L=new u["a"]("https://www.sollet.io");L.on("disconnect",(function(){return console.log("Disconnected")}));var S={name:"App",data:function(){return{cluster:"devnet",userPublicKey:null,programId:"",customProgramId:!1,lotteries:null,sol:null}},components:{CreateLottery:R,Lotteries:K},created:function(){var e=this;L.on("connect",(function(t){console.log("Connected to "+t.toBase58()),e.userPublicKey=t})),L.on("disconnect",(function(){e.userPublicKey=null}))},watch:{cluster:{immediate:!0,handler:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.lotteries=null,Object(s["a"])(B[t].url);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},customProgramId:{immediate:!0,handler:function(e){e||(this.programId=B[this.cluster].programId)}},programId:{immediate:!0,handler:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchLotteries();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},userPublicKey:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.updateUser();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},computed:{userAccountPubkey:function(){var e;return null===(e=this.userPublicKey)||void 0===e?void 0:e.toBase58()},clusters:function(){return Object.keys(B)},theme:function(){return this.$vuetify.theme.dark?"dark":"light"}},methods:{connect:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,L.connect();case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),onEnter:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["b"])(L,t.lotteryAccountPubkey,this.programId);case 2:return n=e.sent,console.log(n),e.next=6,this.fetchLotteries();case 6:return e.next=8,this.updateUser();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onReceive:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["f"])(L,t.lotteryAccountPubkey,this.programId);case 2:return n=e.sent,console.log(n),e.next=6,this.fetchLotteries();case 6:return e.next=8,this.updateUser();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onCreate:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["e"])(L,t,this.programId);case 2:return n=e.sent,console.log("lotteryInfo: ".concat(n.ticketPrice)),e.next=6,this.fetchLotteries();case 6:return e.next=8,this.updateUser();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),fetchLotteries:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.lotteries=null,e.next=3,Object(s["d"])(this.$data.programId);case 3:t=e.sent,console.log(t),this.lotteries=t;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),updateUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.userPublicKey){e.next=7;break}return e.next=3,Object(s["c"])(this.userPublicKey);case 3:t=e.sent,this.sol=t?t.lamports/o["c"]:0,e.next=8;break;case 7:this.sol=null;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},z=S,E=n("0798"),W=n("7496"),G=n("40dc"),M=n("ac7c"),$=n("adda"),U=n("f6c4"),D=n("b974"),J=n("2fa4"),N=n("2a7f"),q=Object(h["a"])(z,a,c,!1,null,null,null),F=q.exports;m()(q,{VAlert:E["a"],VApp:W["a"],VAppBar:G["a"],VBtn:v["a"],VCheckbox:M["a"],VCol:k["a"],VContainer:w["a"],VImg:$["a"],VMain:U["a"],VRow:x["a"],VSelect:D["a"],VSpacer:J["a"],VTextField:P["a"],VToolbarTitle:N["a"]});var Q=n("f309"),H=n("fcf4");r["a"].use(Q["a"]);var X=new Q["a"]({theme:{dark:!0,themes:{dark:{background:H["a"].shades.black}}}});r["a"].config.productionTip=!1,new r["a"]({vuetify:X,render:function(e){return e(F)}}).$mount("#app")},8721:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return m}));n("99af"),n("4de4"),n("d81d"),n("96cf");var r=n("1da1"),a=n("64b9"),c=n("399f"),i=n.n(c),o=n("c4c1"),u=new a["b"]("http://localhost:8899","singleGossip"),s=function(e){u=new a["b"](e,"singleGossip")},l=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.getAccountInfo(t,"singleGossip");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,c){var i,s,l,p,f,d,h,m,v,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=n,console.log("initializer pubKey: ".concat(i.publicKey.toBase58())),s=new a["d"](c),l=new a["a"],t.t0=a["f"],t.t1=i.publicKey,t.t2=l.publicKey,t.t3=o["a"].span,t.next=10,u.getMinimumBalanceForRentExemption(o["a"].span,"singleGossip");case 10:return t.t4=t.sent,t.t5=r*a["c"],t.t6=t.t4+t.t5,t.t7=s,t.t8={fromPubkey:t.t1,newAccountPubkey:t.t2,space:t.t3,lamports:t.t6,programId:t.t7},p=t.t0.createAccount.call(t.t0,t.t8),f=e.concat([e.from([0]),i.publicKey.toBuffer()]),d=new a["h"]({programId:s,keys:[{pubkey:l.publicKey,isSigner:!1,isWritable:!0},{pubkey:a["e"],isSigner:!1,isWritable:!1}],data:f}),h=(new a["g"]).add(p,d),t.next=21,u.getRecentBlockhash();case 21:return h.recentBlockhash=t.sent.blockhash,h.feePayer=n.publicKey,h.sign(l),t.next=26,n.signTransaction(h);case 26:return m=t.sent,t.next=29,u.sendRawTransaction(m.serialize(),{skipPreflight:!1,preflightCommitment:"singleGossip"});case 29:return v=t.sent,console.log("Tx signature: ".concat(v)),t.next=33,u.confirmTransaction(v);case 33:return t.next=35,u.getAccountInfo(l.publicKey,"singleGossip");case 35:return g=t.sent,t.abrupt("return",b(l.publicKey,g));case 37:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),f=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,c){var i,o,s,l,p,f,d,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=n.publicKey,o=new a["d"](r),s=new a["d"](c),l=new a["h"]({programId:s,keys:[{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a["f"].programId,isSigner:!1,isWritable:!1}],data:e.from([1])}),p=(new a["g"]).add(l),t.next=7,u.getRecentBlockhash();case 7:return p.recentBlockhash=t.sent.blockhash,p.feePayer=n.publicKey,t.next=11,n.signTransaction(p);case 11:return f=t.sent,t.next=14,u.sendRawTransaction(f.serialize(),{skipPreflight:!1,preflightCommitment:"singleGossip"});case 14:return d=t.sent,console.log("Tx signature: ".concat(d)),t.next=18,u.confirmTransaction(d);case 18:return t.next=20,u.getAccountInfo(o,"singleGossip");case 20:return h=t.sent,t.abrupt("return",b(o,h));case 22:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),d=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r,c){var i,o,s,l,p,f,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=n.publicKey,o=new a["d"](r),s=new a["d"](c),l=new a["h"]({programId:s,keys:[{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0}],data:e.from([2])}),p=(new a["g"]).add(l),t.next=7,u.getRecentBlockhash();case 7:return p.recentBlockhash=t.sent.blockhash,p.feePayer=n.publicKey,t.next=11,n.signTransaction(p);case 11:return f=t.sent,t.next=14,u.sendRawTransaction(f.serialize(),{skipPreflight:!1,preflightCommitment:"singleGossip"});case 14:return d=t.sent,console.log("Tx signature: ".concat(d)),t.next=18,u.confirmTransaction(d);case 18:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),h="11111111111111111111111111111111",b=function(e,t){var n=o["a"].decode(t.data),r=new a["d"](n.winnerAccountPubkey).toBase58(),c=n.entrants.map((function(e){return new a["d"](e).toBase58()})).filter((function(e){return e!==h}));return{lotteryAccountPubkey:e.toBase58(),isInitialized:!!n.isInitialized,initializerAccountPubkey:new a["d"](n.initializerPubkey).toBase58(),ticketPrice:new i.a(n.ticketPrice,10,"le").toNumber(),winnerAccountPubkey:r!=h?r:null,entrants:c,max_entrant_count:5}},m=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new a["d"](t),e.next=3,u.getProgramAccounts(n,"singleGossip");case 3:return r=e.sent,e.abrupt("return",r.map((function(e){var t=e.pubkey,n=e.account;return b(t,n)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}).call(this,n("1c35").Buffer)},abd5:function(e,t,n){"use strict";n("3de1")},b0e8:function(e,t,n){e.exports=n.p+"img/solanalotto-neon.ac35fa38.jpeg"},c4c1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("901e"),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"publicKey";return r["blob"](32,e)},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uint64";return r["blob"](8,e)},i=5,o=r["struct"]([r["u8"]("isInitialized"),a("initializerPubkey"),c("ticketPrice"),a("winnerAccountPubkey"),r["seq"](a(),i,"entrants")])}});
//# sourceMappingURL=app.c15913f0.js.map